<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
	<head>
		<meta charset="utf-8" />
		<title>Same Page Extended Description</title>
	</head>
	<body>
		<section role="doc-chapter">
			<h1>Same Page Extended Description</h1>
			<p>Here is my image:</p>
			<figure>
				<img id="img1" aria-details="anchor-extended-description-img1" src="chart-ebcaadfb.png" alt="Chart of 2014 First Quarter Visitors to example.com Websites"/>
				<figcaption>
					This is the caption for this image. <a id="anchor-extended-description-img1" href="#extended-description-img1">Extended description</a>.
				</figcaption>
			</figure>
		</section>
		
		<aside id="extended-description-img1">
			<h2>Description of Bar Chart</h2>
			<h3>Overview</h3>
			<p>The chart shows the website hits for the first quarter of 2014. It shows that Site 1 has more visitors than either
				of the other sites, but the number of visitors is decreasing. Site 2 has a fairly constant number of visitors,
				while for Site 3 page hits are increasing month on month.
			</p>
			<h3>Data</h3>
			<table>
				<tr>
					<th scope="col">Period</th>
					<th scope="col">Site 1</th>
					<th scope="col">Site 2</th>
					<th scope="col">Site 3</th>
				</tr>
				<tr>
					<th scope="row">Jan</th>
					<td>135</td>
					<td>112</td>
					<td>92</td>
				</tr>
				<tr>
					<th scope="row">Feb</th>
					<td>117</td>
					<td>114</td>
					<td>99</td>
				</tr>
				<tr>
					<th scope="row">Mar</th>
					<td>96</td>
					<td>111</td>
					<td>126</td>
				</tr>
				<tr>
					<th scope="row">Qtr Total</th>
					<td>348</td>
					<td>337</td>
					<td>308</td>
				</tr>
			</table>
			<h3>Presentation</h3>
			<p>The bar chart represents both the number of visitors per month for each website, and the total number of visitors
				per website for the entire quarter. Website visitors for each month are represented using columns lined up
				horizontally, with heights indicating the number of visitors. A fourth column is provided for each website
				with the accumulated site visitors for the quarter.
			</p>
			<p>
				<a role="doc-backlink" href="#img1">Navigate back to bar chart image</a>.
			</p>
		</aside>

		<script>
			function runTest() {
				console.log('=== XPATH TEST to identify extended descriptions for reading system developers ===');
				
				try {
					// Test 1: identify links to extended descriptions
					const linkXPath = "//a[@id=//img[@aria-details]/@aria-details]";
					const linkResult = document.evaluate(linkXPath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);
					const linkNode = linkResult.singleNodeValue;
					
					console.log('\nTest 1 - identify links to extended descriptions:');
					console.log('\t- XPath used:', linkXPath);
					if (linkNode) {
						console.log('\t- ✓ Link found with ID:', linkNode.id);
						console.log('\t- href:', linkNode.href);
						console.log('\t- HTML element:', linkNode);
					} else {
						console.log('\t- ✗ No links found in the page');
					}
					
				} catch (error) {
					console.error('Error during the test:', error.message);
					console.error('Stack trace:', error.stack);
				}
				
				try {
					// Test 2: identify extended description containers
					const linkXPath = "//*[@id=substring-after(//a[@id=//img[@aria-details]/@aria-details]/@href, '#')]";
					const linkResult = document.evaluate(linkXPath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);
					const linkNode = linkResult.singleNodeValue;
					
					console.log('\nTest 2 - identify extended description containers:');
					console.log('\t- XPath used:', linkXPath);
					if (linkNode) {
						console.log('\t- ✓ Container found with ID:', linkNode.id);
						console.log('\t- HTML element:', linkNode);
					} else {
						console.log('\t- ✗ No containers of extended description found in the page');
					}
					
				} catch (error) {
					console.error('Error during the test:', error.message);
					console.error('Stack trace:', error.stack);
				}
			}
			
			// Run the test automatically when the page loads
			window.addEventListener('load', runTest);
		</script>
		
	</body>
</html>